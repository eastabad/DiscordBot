# 8443端口SSL证书配置说明

## 证书复用方案

### ✅ 使用现有证书（推荐）
你的v2ray已经有SSL证书，Discord Bot可以直接复用：

```nginx
server {
    listen 8443 ssl http2;
    server_name www.tdindicator.top tdindicator.top;

    # 复用你现有的SSL证书
    ssl_certificate /etc/letsencrypt/live/www.tdindicator.top/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/www.tdindicator.top/privkey.pem;
    
    # Discord Bot配置...
}
```

### 🔍 证书位置检查
常见的证书路径：
```bash
# Let's Encrypt证书
/etc/letsencrypt/live/www.tdindicator.top/fullchain.pem
/etc/letsencrypt/live/www.tdindicator.top/privkey.pem

# 或者
/etc/letsencrypt/live/tdindicator.top/fullchain.pem
/etc/letsencrypt/live/tdindicator.top/privkey.pem
```

## 证书验证命令

### 1. 查找现有证书
```bash
# 查看Let's Encrypt证书
sudo ls -la /etc/letsencrypt/live/

# 查看nginx当前使用的证书
sudo grep -r "ssl_certificate" /etc/nginx/
```

### 2. 测试证书有效性
```bash
# 检查证书到期时间
sudo openssl x509 -in /etc/letsencrypt/live/www.tdindicator.top/fullchain.pem -text -noout | grep "Not After"

# 测试8443端口SSL
openssl s_client -connect www.tdindicator.top:8443 -servername www.tdindicator.top
```

## 自动证书检测

我的部署脚本会自动：
1. 检测你现有的证书路径
2. 验证证书有效性
3. 配置8443端口使用相同证书

## Webhook地址

部署完成后，TradingView webhook地址：
```
https://www.tdindicator.top:8443/webhook/tradingview
```

- ✅ 完整的HTTPS加密
- ✅ 使用你现有的SSL证书
- ✅ 与v2ray完全隔离

## 防火墙配置

需要开放8443端口：
```bash
sudo ufw allow 8443
sudo ufw reload
```

## 证书自动续期

如果你的证书是Let's Encrypt：
- 自动续期会同时更新443和8443端口
- 无需额外配置

## 故障排除

如果证书有问题：
```bash
# 查看nginx错误日志
sudo tail -f /var/log/nginx/error.log

# 测试nginx配置
sudo nginx -t

# 检查证书权限
sudo ls -la /etc/letsencrypt/live/www.tdindicator.top/
```